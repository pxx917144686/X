#ifndef IOSurfaceExploit_h
#define IOSurfaceExploit_h

#import <Foundation/Foundation.h>
#import <IOKit/IOKitLib.h>

// IOSurface相关定义
#define kOSSerializeDictionary   0x01000000U
#define kOSSerializeArray        0x02000000U
#define kOSSerializeSet          0x03000000U
#define kOSSerializeNumber       0x04000000U
#define kOSSerializeSymbol       0x08000000U
#define kOSSerializeString       0x09000000U
#define kOSSerializeData         0x0a000000U
#define kOSSerializeBoolean      0x0b000000U
#define kOSSerializeObject       0x0c000000U
#define kOSSerializeEndCollection 0x80000000U
#define kOSSerializeMagic        0x000000d3U

// IOSurface漏洞利用
bool exploit_iosurface_memory_corruption(void);
bool exploit_iosurface_blastdoor_chain(void);

// 辅助函数
mach_port_t IOKitGetMainPort(void);

#endif /* IOSurfaceExploit_h */
