// VMExploit.h
#ifndef VMExploit_h
#define VMExploit_h

#import <Foundation/Foundation.h>
#import <mach/mach.h>

#define VM_BEHAVIOR_ZERO_WIRED_PAGES    10
#define MNT_RDONLY                      0x1
#define OFFSET_MOUNTLIST                0xE000   // 示例偏移，需调整
#define OFFSET_MOUNT_FROMNAME           0x908    // 示例偏移，需调整
#define OFFSET_MOUNT_FLAGS              0x70     // 示例偏移，需调整

// VM子系统漏洞利用主函数
bool exploit_vm_subsystem(void);
bool exploit_vm_zero_wired_pages(void);
bool exploit_vm_subsystem_vulnerabilities(void);

// VM相关工具函数
bool verify_vm_exploit_success(void);
bool setup_tfp0_primitive(void);
bool disable_sip_via_vm_exploit(void);
bool make_root_persistent(void);

// 工具函数
uint64_t find_kernel_base_address(void);
void prepare_ios17_6_heap(void);
uint64_t find_port_address(mach_port_t port);

#endif /* VMExploit_h */
