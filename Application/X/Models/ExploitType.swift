import UIKit
import Foundation

// 漏洞类型枚举
enum ExploitType: String, CaseIterable, Identifiable {
    case userDefaults = "默认"
    case iOS17VM = "iOS 17 VM"
    case WebkitExploit = "WebKit"
    case combinedExploit = "组合漏洞链"
    case fileZero = "文件清零"
    case experimentalExploit = "实验性漏洞"
    // 保留原有的枚举值
    case webkitUAF = "WebKit UAF"
    case coreMediaUAF = "CoreMedia UAF"
    case kernelTypeConfusion = "内核类型混淆"
    case vmBehaviorZero = "VM行为清零"
    case mediaPlayer = "MediaPlayer漏洞"
    case systemTapped = "SystemTapped漏洞"
    
    var id: String { self.rawValue }
    
    var displayName: String {
        switch self {
        case .webkitUAF:
            return "WebKit UAF (CVE-2024-44131)"
        case .coreMediaUAF:
            return "CoreMedia UAF (CVE-2025-24085)"
        case .kernelTypeConfusion:
            return "内核类型混淆 (CVE-2024-23222)"
        case .vmBehaviorZero:
            return "VM行为清零 (VM_BEHAVIOR_ZERO_WIRED_PAGES)"
        case .fileZero:
            return "File Zero 漏洞"
        case .userDefaults:
            return "UserDefaults 漏洞"
        case .mediaPlayer:
            return "MediaPlayer 漏洞"
        case .systemTapped:
            return "SystemTapped 漏洞"
        case .iOS17VM:
            return "iOS 17 VM 漏洞"
        case .WebkitExploit:
            return "WebKit 漏洞"
        case .combinedExploit:
            return "组合漏洞链 漏洞"
        case .experimentalExploit:
            return "实验性漏洞 漏洞"
        }
    }
    
    var description: String {
        switch self {
        case .webkitUAF:
            return "通过WebKit引擎中的UAF漏洞获取初始代码执行权限并突破浏览器沙箱"
        case .coreMediaUAF:
            return "利用CoreMedia框架中的UAF漏洞加载畸形MP4文件，突破应用沙箱"
        case .kernelTypeConfusion:
            return "使用内核类型混淆漏洞提升权限至root，绕过KPP/APRR保护"
        case .vmBehaviorZero:
            return "利用XNU内核VM子系统漏洞，清零只读系统文件"
        case .fileZero:
            return "利用文件系统漏洞获取系统权限"
        case .userDefaults:
            return "利用UserDefaults漏洞获取敏感信息"
        case .mediaPlayer:
            return "利用MediaPlayer漏洞执行任意代码"
        case .systemTapped:
            return "利用SystemTapped漏洞进行系统级别的操作"
        case .iOS17VM:
            return "利用iOS 17 VM子系统漏洞获取内核权限"
        case .WebkitExploit:
            return "利用WebKit引擎中的漏洞执行代码"
        case .combinedExploit:
            return "组合多个漏洞形成完整利用链"
        case .experimentalExploit:
            return "实验性的漏洞利用技术"
        }
    }
    
    var impactLevel: ExploitImpactLevel {
        switch self {
        case .webkitUAF, .WebkitExploit:
            return .medium
        case .coreMediaUAF, .vmBehaviorZero, .fileZero:
            return .high
        case .kernelTypeConfusion, .iOS17VM:
            return .critical
        case .userDefaults, .mediaPlayer, .systemTapped, .combinedExploit, .experimentalExploit:
            return .medium
        }
    }
}

// 漏洞影响级别
enum ExploitImpactLevel {
    case low, medium, high, critical
    
    var color: UIColor {
        switch self {
        case .low:
            return UIColor.systemBlue
        case .medium:
            return UIColor.systemOrange
        case .high:
            return UIColor.systemRed
        case .critical:
            return UIColor(red: 0.5, green: 0, blue: 0, alpha: 1.0) // 深红色
        }
    }
    
    var displayName: String {
        switch self {
        case .low:
            return "低"
        case .medium:
            return "中"
        case .high:
            return "高"
        case .critical:
            return "严重"
        }
    }
}
